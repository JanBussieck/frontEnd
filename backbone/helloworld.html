<!DOCTYPE html>
<html>
<head>
<title>
	backbone.js -hello world
</title>
</head>
<body>
<button id="check"> 报到 </button>
<ul id="world-list">
</ul>
</body>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.1/underscore-min.js"></script>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.0.0/backbone-min.js"></script>

<script type="text/javascript">
(function ($) {
	World = Backbone.Model.extend({
		name: null,
	});
	
	Worlds = Backbone.Collection.extend({
		initialize: function (models, options){
			this.bind("add", options.view.addOneWorld);
		}
	});

	AppView = Backbone.View.extend({
		el: $('body'),
		initialize: function(){
			this.worlds = new Worlds(null, {view: this})
		},
		events: {
			"click #check": "checkIn",
		},
		checkIn: function(){
			var world_name = prompt("请你是哪个星球的");
			if (world_name == "") world_name = "未知";
			var world = new World({name: world_name});
			this.worlds.add(world);
		},
		addOneWorld: function(model){
			$("#world-list").append("<li> 这里是来自<b>"+model.get('name')+ "</b>星球的问候：hello world! </li>");
		}
	});

	Man = Backbone.Model.extend({
		url: '/save/',
		initialize: function(){
			alert("you create a man !");
			this.bind("change:name", function(){
				var name = this.get('name');
				alert("you change the man's name"+name);
			});

			this.bind("error", function(model, error){
				alert(error);
			});
		},
		defaults :{
			name: "some one's name ",
			age: "18"
		},
		validate: function(attributes){
			if(attributes.name == ''){
				return 'name不能为空！';
			}
		},
		aboutMe: function(){
			return "i am"+this.get('name')+"and"+this.get('age');
		}
	});

	var appview = new AppView;
	var man = new Man;
	man.set({name:' zhangsan'});
	// man.save();
	// var man1 = new Man;
	// man1.fetch();
	// man1.fetch({url: '/getmans/'});
	// man1.fetch({url: '/getmans/', success:function(model, response){
	// 	alert('success');
	// 	alert(model.get('name'));
	// }, error: function(){
	// 	alert('error');
	// }});

})(jQuery);

</script>
</html>